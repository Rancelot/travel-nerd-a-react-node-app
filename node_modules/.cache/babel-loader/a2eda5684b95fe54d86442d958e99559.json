{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"D:\\\\GitHub\\\\comp4513-assignment1-version-2\\\\my-app\\\\src\\\\App.js\";\nimport React, { Component } from 'react'; // import HeaderApp from './components/HeaderApp.js';\n\nimport PhotoBrowser from './components/PhotoBrowser.js';\nimport * as cloneDeep from 'lodash/cloneDeep';\nimport { Route } from 'react-router-dom';\nimport Home from './components/Home.js';\nimport About from './components/About.js'; // import Favorites from './components/Favorites.js';\n\nimport _ from 'lodash';\nimport JSZip from 'jszip';\nimport JSZipUtils from 'jszip-utils';\nimport { fileSaver } from 'jszip/vendor/FileSaver.js';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.updateLocalStorage = function (data) {\n      localStorage.setItem('favorites', JSON.stringify(data));\n    };\n\n    _this.getLocalStorageFav = function () {\n      return JSON.parse(localStorage.getItem('favorites'));\n    };\n\n    _this.generateZip = function () {\n      var zip = new JSZip();\n      var folder = zip.folder('project');\n      var url = \"https://storage.googleapis.com/funwebdev-3rd-travel/large/15108090436.jpg\";\n      var blobPromise = fetch(url).then(function (r) {\n        if (r.status === 200) {\n          return r.blob();\n        }\n\n        return Promise.reject(new Error(r.statusText));\n      });\n      var name = url.substring(url.lastIndexOf('/'));\n      folder.file(name, blobPromise);\n      zip.generateAsync({\n        type: \"blob\"\n      }).then(function (blob) {\n        return fileSaver.saveAs(blob, \"test.zip\");\n      }).catch(function (e) {\n        return console.log(e);\n      }); //let zip = new JSZip();\n      //zip.file(\"test.jpg\", this.urlToDownload(\"https://storage.googleapis.com/funwebdev-3rd-travel/large/15108090436.jpg\"), {binary: true});\n      //zip.generateAsync({ type: \"blob\" })\n      //    .then(function (content) {\n      //        zip.saveAs(content, \"test.zip\")\n      //    });\n    };\n\n    _this.urlToDownload = function (url) {\n      return new Promise(function (resolve, reject) {\n        JSZipUtils.getBinaryContent(url, function (err, data) {\n          if (err) {\n            reject(err);\n          } else {\n            resolve(data);\n          }\n        });\n      });\n    };\n\n    _this.updatePhoto = function (id, photo) {\n      //create deep clone of photo array from state\n      //we will use a lodash function for that task\n      var copyPhotos = cloneDeep(_this.state.photos); //find a photo to update in cloned array\n\n      var photoToReplace = copyPhotos.find(function (p) {\n        return p.id === id;\n      }); //replace photo fields with edited values\n\n      photoToReplace.title = photo.title;\n      photoToReplace.city = photo.city;\n      photoToReplace.country = photo.country;\n      photoToReplace.description = photo.description;\n      photoToReplace.latitude = photo.latitude;\n      photoToReplace.longtitude = photo.longtitude; //update state\n\n      _this.setState({\n        photos: copyPhotos\n      });\n    };\n\n    _this.addPhotoToFavorites = function (id) {\n      // find photo to add\n      var photo = _this.state.photos.find(function (p) {\n        return p.id === id;\n      }); // check if item is already in favorite\n      // if not add it\n\n\n      if (!_this.state.favorites.find(function (p) {\n        return p.id === id;\n      })) {\n        // create copy of favorites\n        var copyFavorites = cloneDeep(_this.state.favorites); // push item into array\n\n        copyFavorites.push(photo); // update state\n\n        _this.setState({\n          favorites: copyFavorites\n        });\n\n        console.log(_this.state.favorites); // update local storage\n\n        _this.updateLocalStorage(_this.state.favorites);\n\n        console.log(_this.getLocalStorageFav());\n      } else {\n        alert(\"Photo already in favorites\");\n      }\n    };\n\n    _this.removePhotoFromList = function (id) {\n      var index = _.findIndex(_this.state.photos, ['id', id]);\n\n      if (index > -1) {\n        // create copy of favorites\n        var copyPhotos = cloneDeep(_this.state.photos); //console.log(copyPhotos);\n        // delete photo\n\n        _.remove(copyPhotos, copyPhotos[index]); // update state\n\n\n        _this.setState({\n          photos: copyPhotos\n        });\n      }\n    };\n\n    _this.removePhotoFromFav = function (id) {\n      var index = _.findIndex(_this.state.favorites, ['id', id]);\n\n      if (index > -1) {\n        // create copy of favorites\n        var copyFav = cloneDeep(_this.state.favorites); //console.log(copyPhotos);\n        // delete photo\n\n        _.remove(copyFav, copyFav[index]); // update state\n\n\n        _this.setState({\n          favorites: copyFav\n        }); // update local storage\n\n\n        _this.updateLocalStorage(copyFav);\n      }\n    };\n\n    _this.sortByValue = function (value) {\n      var tmp = cloneDeep(_this.state.photos);\n\n      if (value === \"city\") {\n        tmp.sort(function (a, b) {\n          return a.city > b.city ? 1 : -1;\n        });\n      } else if (value === \"country\") {\n        tmp.sort(function (a, b) {\n          return a.country > b.country ? 1 : -1;\n        });\n      } else {\n        tmp.sort(function (a, b) {\n          return a.id - b.id;\n        });\n      }\n\n      _this.setState({\n        photos: tmp\n      });\n    };\n\n    _this.state = {\n      photos: [],\n      favorites: []\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var url, response, jsonData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.getLocalStorageFav() !== null) {\n                  console.log(this.setState({\n                    favorites: this.getLocalStorageFav()\n                  }));\n                }\n\n                _context.prev = 1;\n                url = \"http://randyconnolly.com/funwebdev/services/travel/images.php\";\n                _context.next = 5;\n                return fetch(url);\n\n              case 5:\n                response = _context.sent;\n                _context.next = 8;\n                return response.json();\n\n              case 8:\n                jsonData = _context.sent;\n                this.setState({\n                  photos: jsonData\n                });\n                console.log(jsonData);\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](1);\n                console.error(_context.t0);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 13]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(Route, {\n        path: \"/\",\n        exact: true,\n        component: Home,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/home\",\n        exact: true,\n        component: Home,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/browse\",\n        exact: true,\n        render: function render(props) {\n          return React.createElement(PhotoBrowser, {\n            generateZip: _this2.generateZip,\n            removePhotoFromFav: _this2.removePhotoFromFav,\n            removePhotoFromList: _this2.removePhotoFromList,\n            sortByValue: _this2.sortByValue,\n            favorites: _this2.state.favorites,\n            photos: _this2.state.photos,\n            updatePhoto: _this2.updatePhoto,\n            addPhotoToFavorites: _this2.addPhotoToFavorites,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 172\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/about\",\n        exact: true,\n        component: About,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["D:\\GitHub\\comp4513-assignment1-version-2\\my-app\\src\\App.js"],"names":["React","Component","PhotoBrowser","cloneDeep","Route","Home","About","_","JSZip","JSZipUtils","fileSaver","App","props","updateLocalStorage","data","localStorage","setItem","JSON","stringify","getLocalStorageFav","parse","getItem","generateZip","zip","folder","url","blobPromise","fetch","then","r","status","blob","Promise","reject","Error","statusText","name","substring","lastIndexOf","file","generateAsync","type","saveAs","catch","e","console","log","urlToDownload","resolve","getBinaryContent","err","updatePhoto","id","photo","copyPhotos","state","photos","photoToReplace","find","p","title","city","country","description","latitude","longtitude","setState","addPhotoToFavorites","favorites","copyFavorites","push","alert","removePhotoFromList","index","findIndex","remove","removePhotoFromFav","copyFav","sortByValue","value","tmp","sort","a","b","response","json","jsonData","error"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n// import HeaderApp from './components/HeaderApp.js';\r\nimport PhotoBrowser from './components/PhotoBrowser.js';\r\nimport * as cloneDeep from 'lodash/cloneDeep';\r\nimport { Route } from 'react-router-dom';\r\nimport Home from './components/Home.js';\r\nimport About from './components/About.js';\r\n// import Favorites from './components/Favorites.js';\r\nimport _ from 'lodash';\r\nimport JSZip from 'jszip';\r\nimport JSZipUtils from 'jszip-utils';\r\nimport { fileSaver } from 'jszip/vendor/FileSaver.js';\r\n\r\nclass App extends Component {\r\n\r\n  constructor(props) {\r\n    super(props); \r\n    this.state = { photos: [], favorites: [] };\r\n  }\r\n\r\n  updateLocalStorage = (data) => {\r\n      localStorage.setItem('favorites', JSON.stringify(data));\r\n  }\r\n\r\n  getLocalStorageFav = () => {\r\n      return JSON.parse(localStorage.getItem('favorites'));\r\n  }\r\n\r\n  generateZip = () => {\r\n\r\n      const zip = new JSZip();\r\n      const folder = zip.folder('project');\r\n      let url = \"https://storage.googleapis.com/funwebdev-3rd-travel/large/15108090436.jpg\";\r\n      const blobPromise = fetch(url).then(r => {\r\n          if (r.status === 200) {\r\n              return r.blob();\r\n          }\r\n          return Promise.reject(new Error(r.statusText));\r\n      });\r\n      const name = url.substring(url.lastIndexOf('/'));\r\n      folder.file(name, blobPromise);\r\n\r\n      zip.generateAsync({ type: \"blob\" }).then(blob => fileSaver.saveAs(blob, \"test.zip\")).catch(e => console.log(e));\r\n\r\n      //let zip = new JSZip();\r\n      //zip.file(\"test.jpg\", this.urlToDownload(\"https://storage.googleapis.com/funwebdev-3rd-travel/large/15108090436.jpg\"), {binary: true});\r\n      //zip.generateAsync({ type: \"blob\" })\r\n      //    .then(function (content) {\r\n      //        zip.saveAs(content, \"test.zip\")\r\n      //    });\r\n  }\r\n\r\n  //https://stuk.github.io/jszip/documentation/examples/downloader.html\r\n  urlToDownload = (url) => {\r\n      return new Promise(function (resolve, reject) {\r\n          JSZipUtils.getBinaryContent(url, function(err, data) {\r\n              if (err) {\r\n                  reject(err);\r\n              } else {\r\n                  resolve(data);\r\n              }\r\n          });\r\n      });\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (this.getLocalStorageFav() !== null) {\r\n        console.log(this.setState({favorites: this.getLocalStorageFav()}));\r\n    }\r\n      try {\r\n          const url = \"http://randyconnolly.com/funwebdev/services/travel/images.php\";\r\n          const response = await fetch(url);\r\n          const jsonData = await response.json();\r\n          this.setState({ photos: jsonData });\r\n          console.log(jsonData);\r\n      } catch (error) {\r\n          console.error(error);\r\n      }\r\n  }\r\n    \r\n  updatePhoto = (id, photo) => {\r\n      //create deep clone of photo array from state\r\n      //we will use a lodash function for that task\r\n      const copyPhotos = cloneDeep(this.state.photos);\r\n      //find a photo to update in cloned array\r\n      const photoToReplace = copyPhotos.find( p => p.id === id);\r\n      //replace photo fields with edited values\r\n      photoToReplace.title = photo.title;\r\n      photoToReplace.city = photo.city;\r\n      photoToReplace.country = photo.country;\r\n      photoToReplace.description = photo.description;\r\n      photoToReplace.latitude = photo.latitude;\r\n      photoToReplace.longtitude = photo.longtitude;\r\n      //update state\r\n      this.setState( {photos: copyPhotos } );\r\n  }\r\n  \r\n  addPhotoToFavorites = (id) => {\r\n    // find photo to add\r\n    const photo = this.state.photos.find (p => p.id === id);\r\n\r\n    // check if item is already in favorite\r\n    // if not add it\r\n    if (!this.state.favorites.find (p => p.id === id)) {\r\n        // create copy of favorites\r\n        const copyFavorites = cloneDeep(this.state.favorites);\r\n\r\n        // push item into array\r\n        copyFavorites.push(photo);\r\n\r\n        // update state\r\n        this.setState({favorites: copyFavorites});\r\n        console.log(this.state.favorites);\r\n\r\n        // update local storage\r\n        this.updateLocalStorage(this.state.favorites);\r\n        console.log(this.getLocalStorageFav());\r\n    } else {\r\n        alert(\"Photo already in favorites\");\r\n    }\r\n  }\r\n\r\n  removePhotoFromList = (id) => {\r\n      let index = _.findIndex(this.state.photos, ['id', id]);\r\n      \r\n      if (index > -1) {\r\n          // create copy of favorites\r\n          const copyPhotos = cloneDeep(this.state.photos);\r\n          //console.log(copyPhotos);\r\n          // delete photo\r\n          _.remove(copyPhotos, copyPhotos[index]);\r\n          // update state\r\n          this.setState({ photos: copyPhotos });\r\n      }\r\n  }\r\n\r\n  removePhotoFromFav = (id) => {\r\n    let index = _.findIndex(this.state.favorites, ['id', id]);\r\n    \r\n    if (index > -1) {\r\n        // create copy of favorites\r\n        const copyFav = cloneDeep(this.state.favorites);\r\n        //console.log(copyPhotos);\r\n        // delete photo\r\n        _.remove(copyFav, copyFav[index]);\r\n        // update state\r\n        this.setState({ favorites: copyFav });\r\n\r\n        // update local storage\r\n        this.updateLocalStorage(copyFav);\r\n    }\r\n}\r\n\r\n  sortByValue = (value) => {\r\n    let tmp = cloneDeep(this.state.photos);\r\n    if (value === \"city\") {\r\n        tmp.sort( (a,b) => a.city > b.city ? 1:-1);\r\n    } else if (value === \"country\")  {\r\n        tmp.sort( (a,b) => a.country > b.country ? 1:-1);\r\n    } else {\r\n        tmp.sort( (a,b) => a.id - b.id);\r\n    }\r\n    this.setState({photos: tmp});\r\n  }\r\n\r\n  render() {\r\n    return (\r\n        <div>\r\n            <Route path='/' exact component={Home} />\r\n            <Route path='/home' exact component={Home} />\r\n            <Route path='/browse' exact render={(props) =>\r\n                <PhotoBrowser generateZip={this.generateZip} removePhotoFromFav={this.removePhotoFromFav} removePhotoFromList={this.removePhotoFromList} sortByValue={this.sortByValue} favorites={this.state.favorites} photos={this.state.photos} updatePhoto={this.updatePhoto} addPhotoToFavorites={this.addPhotoToFavorites} /> \r\n            }\r\n            />\r\n            <Route path='/about' exact component={About} />\r\n\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}